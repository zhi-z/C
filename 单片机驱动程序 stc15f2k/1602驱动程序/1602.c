/*********************************************************************************
* 文件名     :  1602.c
* 描述       :  1602模块源文件
 
* 版本     作者            日期            说明
* V1.0      zhi-z            2014/02/6       初始版本
*********************************************************************************/
#include"1602.h"


/*******************************************************************************
* 函数描述 : 延时函数
* 隶属模块 : 外部
* 输入参数 : unsigned char z ,延时参数
* 返回参数 : 无
*******************************************************************************/

void delay (unsigned int z)		
{
	unsigned int i , j ;
	for (i = z ; i > 0 ; i--)
		for (j = 1700 ; j > 0 ; j--); 
}

/*******************************************************************************
* 函数描述 : 1602写命令函数
* 隶属模块 : 内部
* 输入参数 : com,8位命令
* 返回参数 : 无
*******************************************************************************/

void write_com (char com)		
{
	rs = 0 ;	//低电平选择命令模式
	P0 = com ;//把指令赋指P0口
	delay (5) ;
	cs = 1 ;	//打开使能端，接受数据
	delay (5) ;
	cs = 0 ;	//关闭使能端
}
 
/*******************************************************************************
* 函数描述 : 1602写数据函数
* 隶属模块 : 内部
* 输入参数 : date,8为数据
* 返回参数 : 无
*******************************************************************************/

void write_data (char date)		
{
	rs = 1 ;		//高电平，选择写数据模式
	P0 = date ;	//把数据值赋给P0口
	delay (5) ;
	cs = 1 ;		//打开使能端
	delay (5) ;
	cs = 0 ;		//关闭使能端
}
 
/*******************************************************************************
* 函数描述 : 1602初始化函数
* 隶属模块 : 外部
* 输入参数 : 无
* 返回参数 : 无
*******************************************************************************/

void init()
{	
	rw = 0 ;//读写选择端，低电平为写入模式
    cs = 0 ;//把使能端置低。
	write_com(0x38);	//显示模式
	write_com(0x0c);	//设计开显示，不显示光标。
	write_com(0x06);	//写入一个字符后地址指针加1
	write_com(0x01);	//清屏
}
 

/*******************************************************************************
* 函数描述 :显示函数，
* 隶属模块 : 外部
* 输入参数 : 
* 返回参数 : 
*******************************************************************************/
void show(unsigned char x,unsigned char *p)
{
	write_com (x);

	while( *p != '\0')
	{
		write_data (*p);
		p++;
	}


}	